<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Bsoft: /Users/heymannb/b20/bsoft/include/mg_ctf_fit.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="Bsoft_icon128.jpg"/></td>
  <td id="projectalign">
   <div id="projectname">Bsoft<span id="projectnumber">&#160;2.2.0</span>
   </div>
   <div id="projectbrief">Bernard&#39;s software package</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('mg__ctf__fit_8h.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">mg_ctf_fit.h File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Header file for CTF (contrast transfer function) functions.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="rwimg_8h.html">rwimg.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="ctf_8h.html">ctf.h</a>&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a9f8dba604710ff1a72c85cd134229659" id="r_a9f8dba604710ff1a72c85cd134229659"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9f8dba604710ff1a72c85cd134229659">img_ctf_radial_average</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, long n, <a class="el" href="class_c_t_fparam.html">CTFparam</a> &amp;em_ctf)</td></tr>
<tr class="memdesc:a9f8dba604710ff1a72c85cd134229659"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the power spectrum radial average corrected for astigmatism.  <br /></td></tr>
<tr class="separator:a9f8dba604710ff1a72c85cd134229659"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a27923f615c2a8f063ead14ba74cd6deb" id="r_a27923f615c2a8f063ead14ba74cd6deb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a27923f615c2a8f063ead14ba74cd6deb">img_ctf_fit_prepare</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, double tmax, double sigma)</td></tr>
<tr class="separator:a27923f615c2a8f063ead14ba74cd6deb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6cc664ab1fac40ecb1ba875bd3789cbd" id="r_a6cc664ab1fac40ecb1ba875bd3789cbd"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6cc664ab1fac40ecb1ba875bd3789cbd">img_ctf_fit_prepare</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, long n, double tmax, double sigma)</td></tr>
<tr class="separator:a6cc664ab1fac40ecb1ba875bd3789cbd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a39a0c06ad0e5a580c38e8cfa056251af" id="r_a39a0c06ad0e5a580c38e8cfa056251af"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a39a0c06ad0e5a580c38e8cfa056251af">img_ctf_fit</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, long n, <a class="el" href="class_c_t_fparam.html">CTFparam</a> &amp;em_ctf, double lores, double hires, double def_start=1e3, double def_end=2e5, double def_inc=1e3, int flag=0)</td></tr>
<tr class="separator:a39a0c06ad0e5a580c38e8cfa056251af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a914828856f28065d3daceb2a1c2cd21b" id="r_a914828856f28065d3daceb2a1c2cd21b"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a914828856f28065d3daceb2a1c2cd21b">img_ctf_isotropy</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, long n, double lores, double hires)</td></tr>
<tr class="separator:a914828856f28065d3daceb2a1c2cd21b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a804fa46726d940f0c0ed88f2da0a6825" id="r_a804fa46726d940f0c0ed88f2da0a6825"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a804fa46726d940f0c0ed88f2da0a6825">img_ctf_fit_baseline</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, long n, <a class="el" href="class_c_t_fparam.html">CTFparam</a> &amp;em_ctf, double lores, double hires)</td></tr>
<tr class="memdesc:a804fa46726d940f0c0ed88f2da0a6825"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fits only the baseline for a given CTF.  <br /></td></tr>
<tr class="separator:a804fa46726d940f0c0ed88f2da0a6825"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0cc671d77d351f03aa631bb40927eca" id="r_ac0cc671d77d351f03aa631bb40927eca"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac0cc671d77d351f03aa631bb40927eca">img_ctf_fit_envelope</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, long n, <a class="el" href="class_c_t_fparam.html">CTFparam</a> &amp;em_ctf, double lores, double hires)</td></tr>
<tr class="memdesc:ac0cc671d77d351f03aa631bb40927eca"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fits only the envelope for a given CTF.  <br /></td></tr>
<tr class="separator:ac0cc671d77d351f03aa631bb40927eca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a992dc61b8dc4b45c9e4b36c94d169f07" id="r_a992dc61b8dc4b45c9e4b36c94d169f07"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a992dc61b8dc4b45c9e4b36c94d169f07">img_ctf_fit_baseline_envelope</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, long n, <a class="el" href="class_c_t_fparam.html">CTFparam</a> &amp;em_ctf, double lores, double hires)</td></tr>
<tr class="memdesc:a992dc61b8dc4b45c9e4b36c94d169f07"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fits the baseline and envelope for a given CTF.  <br /></td></tr>
<tr class="separator:a992dc61b8dc4b45c9e4b36c94d169f07"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af985f1e858d119ade8d519e2f14ed128" id="r_af985f1e858d119ade8d519e2f14ed128"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af985f1e858d119ade8d519e2f14ed128">ctf_find_defocus</a> (vector&lt; double &gt; &amp;v, <a class="el" href="class_c_t_fparam.html">CTFparam</a> &amp;em_ctf, long rmin, long rmax, double step_size, double def_start, double def_end, double def_inc)</td></tr>
<tr class="separator:af985f1e858d119ade8d519e2f14ed128"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1989e9d1c03ba60781fa02d0b5e7d402" id="r_a1989e9d1c03ba60781fa02d0b5e7d402"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1989e9d1c03ba60781fa02d0b5e7d402">img_ctf_find_defocus</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, long n, <a class="el" href="class_c_t_fparam.html">CTFparam</a> &amp;em_ctf, double lores, double hires, double def_start=1e3, double def_end=2e5, double def_inc=1e3)</td></tr>
<tr class="memdesc:a1989e9d1c03ba60781fa02d0b5e7d402"><td class="mdescLeft">&#160;</td><td class="mdescRight">Searches for the defocus based on correlation.  <br /></td></tr>
<tr class="separator:a1989e9d1c03ba60781fa02d0b5e7d402"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67531ca1d0884d83e11cf25873f1e95b" id="r_a67531ca1d0884d83e11cf25873f1e95b"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a67531ca1d0884d83e11cf25873f1e95b">img_ctf_fit_astigmatism</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, long n, <a class="el" href="class_c_t_fparam.html">CTFparam</a> &amp;em_ctf, double lores, double hires)</td></tr>
<tr class="memdesc:a67531ca1d0884d83e11cf25873f1e95b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fits the astigmatism with a given defocus, baseline and envelope.  <br /></td></tr>
<tr class="separator:a67531ca1d0884d83e11cf25873f1e95b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06c8c0e3f5818a706295fd04ad11d902" id="r_a06c8c0e3f5818a706295fd04ad11d902"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a06c8c0e3f5818a706295fd04ad11d902">img_add_aberration_terms</a> (<a class="el" href="class_bimage.html">Bimage</a> *psum, <a class="el" href="class_bimage.html">Bimage</a> *psec, <a class="el" href="class_bimage.html">Bimage</a> *p, <a class="el" href="class_c_t_fparam.html">CTFparam</a> &amp;cp, bool ew_flag=0)</td></tr>
<tr class="separator:a06c8c0e3f5818a706295fd04ad11d902"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b7459521929e8d2ee56bffc48ac562c" id="r_a0b7459521929e8d2ee56bffc48ac562c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0b7459521929e8d2ee56bffc48ac562c">img_calculate_phase_differences</a> (<a class="el" href="class_bimage.html">Bimage</a> *psum, int check_contrast=0)</td></tr>
<tr class="separator:a0b7459521929e8d2ee56bffc48ac562c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2cb96e1c6e896f9d20f13ded2c816fe" id="r_af2cb96e1c6e896f9d20f13ded2c816fe"><td class="memItemLeft" align="right" valign="top">vector&lt; map&lt; pair&lt; long, long &gt;, double &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af2cb96e1c6e896f9d20f13ded2c816fe">img_aberration_phase_fit</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, double lores, double hires, int flag=0, long iter=0)</td></tr>
<tr class="separator:af2cb96e1c6e896f9d20f13ded2c816fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a176a2573d86c80715a90e0063cd40b69" id="r_a176a2573d86c80715a90e0063cd40b69"><td class="memItemLeft" align="right" valign="top">vector&lt; map&lt; pair&lt; long, long &gt;, double &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a176a2573d86c80715a90e0063cd40b69">img_aberration_phase_fit</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, double lores, double hires, vector&lt; map&lt; pair&lt; long, long &gt;, double &gt; &gt; &amp;win, int flag, long iter)</td></tr>
<tr class="memdesc:a176a2573d86c80715a90e0063cd40b69"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fits a phase image with aberration terms.  <br /></td></tr>
<tr class="separator:a176a2573d86c80715a90e0063cd40b69"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6bcbb9f31ffc1676eaa64d9811f226a0" id="r_a6bcbb9f31ffc1676eaa64d9811f226a0"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6bcbb9f31ffc1676eaa64d9811f226a0">img_ctf_fit_aberration</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, long n, <a class="el" href="class_c_t_fparam.html">CTFparam</a> &amp;em_ctf, double lores, double hires)</td></tr>
<tr class="separator:a6bcbb9f31ffc1676eaa64d9811f226a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ac841c36d48f32c91f0439f905d9ceb" id="r_a2ac841c36d48f32c91f0439f905d9ceb"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2ac841c36d48f32c91f0439f905d9ceb">img_water_ring_index</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, long img_num, <a class="el" href="class_c_t_fparam.html">CTFparam</a> &amp;em_ctf)</td></tr>
<tr class="memdesc:a2ac841c36d48f32c91f0439f905d9ceb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the water ring index from a power spectrum.  <br /></td></tr>
<tr class="separator:a2ac841c36d48f32c91f0439f905d9ceb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2220d1b5ffa128bfeeedffbb5fa5dfc" id="r_ac2220d1b5ffa128bfeeedffbb5fa5dfc"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac2220d1b5ffa128bfeeedffbb5fa5dfc">img_water_ring_index</a> (<a class="el" href="class_bimage.html">Bimage</a> *prad)</td></tr>
<tr class="memdesc:ac2220d1b5ffa128bfeeedffbb5fa5dfc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the water ring index from a power spectrum.  <br /></td></tr>
<tr class="separator:ac2220d1b5ffa128bfeeedffbb5fa5dfc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94bac8ac210dd593060082a20198b685" id="r_a94bac8ac210dd593060082a20198b685"><td class="memItemLeft" align="right" valign="top">vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a94bac8ac210dd593060082a20198b685">img_fit_water_ring</a> (<a class="el" href="class_bimage.html">Bimage</a> *p)</td></tr>
<tr class="separator:a94bac8ac210dd593060082a20198b685"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Header file for CTF (contrast transfer function) functions. </p>
<dl class="section author"><dt>Author</dt><dd>Bernard Heymann </dd></dl>
<dl class="section date"><dt>Date</dt><dd>Created: 20000426 </dd>
<dd>
Modified: 20240307 </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="af985f1e858d119ade8d519e2f14ed128" name="af985f1e858d119ade8d519e2f14ed128"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af985f1e858d119ade8d519e2f14ed128">&#9670;&#160;</a></span>ctf_find_defocus()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double ctf_find_defocus </td>
          <td>(</td>
          <td class="paramtype">vector&lt; double &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>v</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_c_t_fparam.html">CTFparam</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>em_ctf</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long</td>          <td class="paramname"><span class="paramname"><em>rmin</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long</td>          <td class="paramname"><span class="paramname"><em>rmax</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>step_size</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>def_start</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>def_end</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>def_inc</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="af2cb96e1c6e896f9d20f13ded2c816fe" name="af2cb96e1c6e896f9d20f13ded2c816fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af2cb96e1c6e896f9d20f13ded2c816fe">&#9670;&#160;</a></span>img_aberration_phase_fit() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">vector&lt; map&lt; pair&lt; long, long &gt;, double &gt; &gt; img_aberration_phase_fit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *</td>          <td class="paramname"><span class="paramname"><em>p</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>lores</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>hires</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>flag</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long</td>          <td class="paramname"><span class="paramname"><em>iter</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a176a2573d86c80715a90e0063cd40b69" name="a176a2573d86c80715a90e0063cd40b69"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a176a2573d86c80715a90e0063cd40b69">&#9670;&#160;</a></span>img_aberration_phase_fit() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">vector&lt; map&lt; pair&lt; long, long &gt;, double &gt; &gt; img_aberration_phase_fit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *</td>          <td class="paramname"><span class="paramname"><em>p</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>lores</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>hires</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; map&lt; pair&lt; long, long &gt;, double &gt; &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>win</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>flag</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long</td>          <td class="paramname"><span class="paramname"><em>iter</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fits a phase image with aberration terms. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*p</td><td>phase image. </td></tr>
    <tr><td class="paramname">lores</td><td>low resolution limit. </td></tr>
    <tr><td class="paramname">hires</td><td>high resolution limit. </td></tr>
    <tr><td class="paramname">win</td><td>initial aberration parameters. </td></tr>
    <tr><td class="paramname">flag</td><td>0=full, 1=odd, 2=even. </td></tr>
    <tr><td class="paramname">iter</td><td>maximum number of iterations. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>vector&lt;map&lt;pair&lt;long,long&gt;,double&gt;&gt; vector of aberration weights. </dd></dl>

</div>
</div>
<a id="a06c8c0e3f5818a706295fd04ad11d902" name="a06c8c0e3f5818a706295fd04ad11d902"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a06c8c0e3f5818a706295fd04ad11d902">&#9670;&#160;</a></span>img_add_aberration_terms()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int img_add_aberration_terms </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *</td>          <td class="paramname"><span class="paramname"><em>psum</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *</td>          <td class="paramname"><span class="paramname"><em>psec</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *</td>          <td class="paramname"><span class="paramname"><em>p</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_c_t_fparam.html">CTFparam</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>cp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>ew_flag</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a0b7459521929e8d2ee56bffc48ac562c" name="a0b7459521929e8d2ee56bffc48ac562c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b7459521929e8d2ee56bffc48ac562c">&#9670;&#160;</a></span>img_calculate_phase_differences()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_bimage.html">Bimage</a> * img_calculate_phase_differences </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *</td>          <td class="paramname"><span class="paramname"><em>psum</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>check_contrast</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a1989e9d1c03ba60781fa02d0b5e7d402" name="a1989e9d1c03ba60781fa02d0b5e7d402"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1989e9d1c03ba60781fa02d0b5e7d402">&#9670;&#160;</a></span>img_ctf_find_defocus()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double img_ctf_find_defocus </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *</td>          <td class="paramname"><span class="paramname"><em>p</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_c_t_fparam.html">CTFparam</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>em_ctf</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>lores</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>hires</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>def_start</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>def_end</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>def_inc</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Searches for the defocus based on correlation. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*p</td><td>image structure. </td></tr>
    <tr><td class="paramname">n</td><td>sub-image number. </td></tr>
    <tr><td class="paramname">&amp;em_ctf</td><td>CTF parameter structure. </td></tr>
    <tr><td class="paramname">lores</td><td>low resolution limit. </td></tr>
    <tr><td class="paramname">hires</td><td>high resolution limit. </td></tr>
    <tr><td class="paramname">def_start</td><td>defocus search start (default 1e3). </td></tr>
    <tr><td class="paramname">def_end</td><td>defocus search end (default 2e5). </td></tr>
    <tr><td class="paramname">def_inc</td><td>defocus search increment (default 1e3). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double R factor. <pre class="fragment">A radial power spectrum is calculated.
A range of defocus values is tested (1000-200000 angstrom, 0.1-20 um), 
and the best fitting value accepted.
The new parameters are written into the CTFparam structure.
</pre> </dd></dl>

</div>
</div>
<a id="a39a0c06ad0e5a580c38e8cfa056251af" name="a39a0c06ad0e5a580c38e8cfa056251af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a39a0c06ad0e5a580c38e8cfa056251af">&#9670;&#160;</a></span>img_ctf_fit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double img_ctf_fit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *</td>          <td class="paramname"><span class="paramname"><em>p</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_c_t_fparam.html">CTFparam</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>em_ctf</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>lores</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>hires</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>def_start</em></span><span class="paramdefsep"> = </span><span class="paramdefval">1e3</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>def_end</em></span><span class="paramdefsep"> = </span><span class="paramdefval">2e5</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>def_inc</em></span><span class="paramdefsep"> = </span><span class="paramdefval">1e3</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>flag</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a6bcbb9f31ffc1676eaa64d9811f226a0" name="a6bcbb9f31ffc1676eaa64d9811f226a0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6bcbb9f31ffc1676eaa64d9811f226a0">&#9670;&#160;</a></span>img_ctf_fit_aberration()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double img_ctf_fit_aberration </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *</td>          <td class="paramname"><span class="paramname"><em>p</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_c_t_fparam.html">CTFparam</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>em_ctf</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>lores</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>hires</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a67531ca1d0884d83e11cf25873f1e95b" name="a67531ca1d0884d83e11cf25873f1e95b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a67531ca1d0884d83e11cf25873f1e95b">&#9670;&#160;</a></span>img_ctf_fit_astigmatism()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double img_ctf_fit_astigmatism </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *</td>          <td class="paramname"><span class="paramname"><em>p</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_c_t_fparam.html">CTFparam</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>em_ctf</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>lores</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>hires</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fits the astigmatism with a given defocus, baseline and envelope. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*p</td><td>image structure. </td></tr>
    <tr><td class="paramname">n</td><td>sub-image number. </td></tr>
    <tr><td class="paramname">&amp;em_ctf</td><td>CTF parameter structure. </td></tr>
    <tr><td class="paramname">lores</td><td>low resolution limit. </td></tr>
    <tr><td class="paramname">hires</td><td>high resolution limit </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double objective measure (larger is better). <pre class="fragment">A radial power spectrum is calculated and the baseline subtracted.
The defocus deviation starts from a low value to get an estimate of
the astigmatism angle. The defocus deviation is modified nased on
the direction of improvements in the fit, at each iteration 
narrowing the angular search for the astigmatism angle.
The new parameters are written into the CTFparam structure.
</pre> </dd></dl>

</div>
</div>
<a id="a804fa46726d940f0c0ed88f2da0a6825" name="a804fa46726d940f0c0ed88f2da0a6825"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a804fa46726d940f0c0ed88f2da0a6825">&#9670;&#160;</a></span>img_ctf_fit_baseline()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double img_ctf_fit_baseline </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *</td>          <td class="paramname"><span class="paramname"><em>p</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_c_t_fparam.html">CTFparam</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>em_ctf</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>lores</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>hires</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fits only the baseline for a given CTF. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*p</td><td>image structure. </td></tr>
    <tr><td class="paramname">n</td><td>sub-image number. </td></tr>
    <tr><td class="paramname">&amp;em_ctf</td><td>CTF parameter structure. </td></tr>
    <tr><td class="paramname">lores</td><td>low resolution limit. </td></tr>
    <tr><td class="paramname">hires</td><td>high resolution limit </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double R factor. <pre class="fragment">A radial power spectrum is calculated incorporating astigmatism.
The baseline of the required type is fit.
The new parameters are written into the CTFparam structure.
</pre> </dd></dl>

</div>
</div>
<a id="a992dc61b8dc4b45c9e4b36c94d169f07" name="a992dc61b8dc4b45c9e4b36c94d169f07"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a992dc61b8dc4b45c9e4b36c94d169f07">&#9670;&#160;</a></span>img_ctf_fit_baseline_envelope()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double img_ctf_fit_baseline_envelope </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *</td>          <td class="paramname"><span class="paramname"><em>p</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_c_t_fparam.html">CTFparam</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>em_ctf</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>lores</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>hires</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fits the baseline and envelope for a given CTF. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*p</td><td>image structure. </td></tr>
    <tr><td class="paramname">n</td><td>sub-image number. </td></tr>
    <tr><td class="paramname">&amp;em_ctf</td><td>CTF parameter structure. </td></tr>
    <tr><td class="paramname">lores</td><td>low resolution limit. </td></tr>
    <tr><td class="paramname">hires</td><td>high resolution limit </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double R factor. <pre class="fragment">A radial power spectrum is calculated incorporating astigmatism.
The baseline and envelope is fit.
The new parameters are written into the CTFparam structure.
</pre> </dd></dl>

</div>
</div>
<a id="ac0cc671d77d351f03aa631bb40927eca" name="ac0cc671d77d351f03aa631bb40927eca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac0cc671d77d351f03aa631bb40927eca">&#9670;&#160;</a></span>img_ctf_fit_envelope()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double img_ctf_fit_envelope </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *</td>          <td class="paramname"><span class="paramname"><em>p</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_c_t_fparam.html">CTFparam</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>em_ctf</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>lores</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>hires</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fits only the envelope for a given CTF. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*p</td><td>image structure. </td></tr>
    <tr><td class="paramname">n</td><td>sub-image number. </td></tr>
    <tr><td class="paramname">&amp;em_ctf</td><td>CTF parameter structure. </td></tr>
    <tr><td class="paramname">lores</td><td>low resolution limit. </td></tr>
    <tr><td class="paramname">hires</td><td>high resolution limit </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double R factor. <pre class="fragment">A radial power spectrum is calculated incorporating astigmatism.
The envelope is fit.
The new parameters are written into the CTFparam structure.
</pre> </dd></dl>

</div>
</div>
<a id="a27923f615c2a8f063ead14ba74cd6deb" name="a27923f615c2a8f063ead14ba74cd6deb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a27923f615c2a8f063ead14ba74cd6deb">&#9670;&#160;</a></span>img_ctf_fit_prepare() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_bimage.html">Bimage</a> * img_ctf_fit_prepare </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *</td>          <td class="paramname"><span class="paramname"><em>p</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>tmax</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>sigma</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a6cc664ab1fac40ecb1ba875bd3789cbd" name="a6cc664ab1fac40ecb1ba875bd3789cbd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6cc664ab1fac40ecb1ba875bd3789cbd">&#9670;&#160;</a></span>img_ctf_fit_prepare() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_bimage.html">Bimage</a> * img_ctf_fit_prepare </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *</td>          <td class="paramname"><span class="paramname"><em>p</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>tmax</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>sigma</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a914828856f28065d3daceb2a1c2cd21b" name="a914828856f28065d3daceb2a1c2cd21b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a914828856f28065d3daceb2a1c2cd21b">&#9670;&#160;</a></span>img_ctf_isotropy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double img_ctf_isotropy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *</td>          <td class="paramname"><span class="paramname"><em>p</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>lores</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>hires</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a9f8dba604710ff1a72c85cd134229659" name="a9f8dba604710ff1a72c85cd134229659"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9f8dba604710ff1a72c85cd134229659">&#9670;&#160;</a></span>img_ctf_radial_average()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_bimage.html">Bimage</a> * img_ctf_radial_average </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *</td>          <td class="paramname"><span class="paramname"><em>p</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_c_t_fparam.html">CTFparam</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>em_ctf</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the power spectrum radial average corrected for astigmatism. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*p</td><td>image structure. </td></tr>
    <tr><td class="paramname">n</td><td>sub-image number. </td></tr>
    <tr><td class="paramname">&amp;em_ctf</td><td>CTF parameter structure. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Bimage* radial average, NULL on error. <pre class="fragment">A power spectrum with its origin at the center.
Functions:
    angle = atan(y/x) - astigmatism_angle
    s2 = reciprocal space distance squared
    defocus_min = defocus_avg - defocus_dev
    defocus_max = defocus_avg + defocus_dev
    smin2 = 1 - defocus_dev/defocus_avg
    smax2 = 1 + defocus_dev/defocus_avg
    radius = sqrt(2*s2*(smax2*cos(angle)*cos(angle)+
                smin2*sin(angle)*sin(angle))/(smax2+smin2))
The radial average is returned as a new 1D image.
</pre> </dd></dl>

</div>
</div>
<a id="a94bac8ac210dd593060082a20198b685" name="a94bac8ac210dd593060082a20198b685"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a94bac8ac210dd593060082a20198b685">&#9670;&#160;</a></span>img_fit_water_ring()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">vector&lt; double &gt; img_fit_water_ring </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *</td>          <td class="paramname"><span class="paramname"><em>p</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a2ac841c36d48f32c91f0439f905d9ceb" name="a2ac841c36d48f32c91f0439f905d9ceb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2ac841c36d48f32c91f0439f905d9ceb">&#9670;&#160;</a></span>img_water_ring_index() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double img_water_ring_index </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *</td>          <td class="paramname"><span class="paramname"><em>p</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long</td>          <td class="paramname"><span class="paramname"><em>img_num</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_c_t_fparam.html">CTFparam</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>em_ctf</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the water ring index from a power spectrum. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*p</td><td>power spectrum. </td></tr>
    <tr><td class="paramname">img_num</td><td>sub-image number. </td></tr>
    <tr><td class="paramname">&amp;em_ctf</td><td>CTF parameter structure. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double water ing index. <pre class="fragment">A radial power spectrum is calculated.
The the water ring index is defined as:
    wri = wp/b - 1
where wp is the intensity at s=0.26 (3.8 Å) and b is the background.
The background is estimated as the average of sections before and after 
the water peak:
    b1 between s=0.1 and s=0.2
    b2 between s=0.3 and s=0.4
</pre> </dd></dl>

</div>
</div>
<a id="ac2220d1b5ffa128bfeeedffbb5fa5dfc" name="ac2220d1b5ffa128bfeeedffbb5fa5dfc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac2220d1b5ffa128bfeeedffbb5fa5dfc">&#9670;&#160;</a></span>img_water_ring_index() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double img_water_ring_index </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *</td>          <td class="paramname"><span class="paramname"><em>prad</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the water ring index from a power spectrum. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*prad</td><td>radial power spectrum. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double water ing index. <pre class="fragment">The the water ring index is defined as:
    wri = wp/b - 1
where wp is the average intensity between 0.2 and 0.3, covering the 
peak at s=0.26 (3.8 Å).
The background, b, is estimated as the average of sections before and after 
the water peak:
    b1 between s=0.1 and s=0.2
    b2 between s=0.3 and s=0.4
</pre> </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="mg__ctf__fit_8h.html">mg_ctf_fit.h</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0 </li>
  </ul>
</div>
</body>
</html>
